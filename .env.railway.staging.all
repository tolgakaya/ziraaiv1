# ========================================
# Railway Staging Environment Variables
# Complete Configuration for ZiraAI API
# ========================================
# Last Updated: 2025-01-09
# Railway Project: ziraai-api-sit
# ========================================

# ====================
# Core Configuration
# ====================
ASPNETCORE_ENVIRONMENT="Staging"
ASPNETCORE_URLS="http://0.0.0.0:8080"
DOTNET_RUNNING_IN_CONTAINER="true"
DOTNET_SYSTEM_GLOBALIZATION_INVARIANT="false"

# ====================
# Database Configuration (PostgreSQL) - WORKING ✅
# ====================
# Primary connection string variables with timeout and pooling configuration
# IMPORTANT: Added timeout and connection pooling parameters to prevent timeout errors
DATABASE_CONNECTION_STRING="Host=tramway.proxy.rlwy.net;Port=39540;Database=railway;Username=postgres;Password=cEAvVsWsZIHDUaUKUMiSTRaTGmuswdEd;Timeout=30;Command Timeout=30;Max Pool Size=50;Min Pool Size=5;Connection Idle Lifetime=300;Connection Lifetime=0;Pooling=true;Connection Pruning Interval=10"
ConnectionStrings__DArchPgContext="Host=tramway.proxy.rlwy.net;Port=39540;Database=railway;Username=postgres;Password=cEAvVsWsZIHDUaUKUMiSTRaTGmuswdEd;Timeout=30;Command Timeout=30;Max Pool Size=50;Min Pool Size=5;Connection Idle Lifetime=300;Connection Lifetime=0;Pooling=true;Connection Pruning Interval=10"

# ====================
# Redis Configuration - WORKING ✅
# ====================
# Redis connection variables (multiple formats for compatibility)
REDIS_HOST="maglev.proxy.rlwy.net"
REDIS_PORT="38265"
REDIS_PASSWORD="pFCgxGquNowJtjLBguvHLXMhyRghrcxv"
REDIS_USERNAME="default"
REDISHOST="maglev.proxy.rlwy.net"
REDISPORT="38265"
REDISPASSWORD="pFCgxGquNowJtjLBguvHLXMhyRghrcxv"
REDISUSER="default"

# .NET Core formatted Redis configuration
CacheOptions__Host="maglev.proxy.rlwy.net"
CacheOptions__Port="38265"
CacheOptions__Password="pFCgxGquNowJtjLBguvHLXMhyRghrcxv"
CacheOptions__Database="0"
CacheOptions__Ssl="false"

# ====================
# JWT Token Configuration
# ====================
TokenOptions__Audience="ZiraAI_Staging_Users"
TokenOptions__Issuer="ZiraAI_Staging"
TokenOptions__AccessTokenExpiration="60"
TokenOptions__RefreshTokenExpiration="180"
TokenOptions__SecurityKey="ZiraAI-Staging-JWT-SecretKey-2025!@"

# Legacy JWT variables (for backward compatibility)
JWT_SECRET_KEY="ZiraAI-Staging-JWT-SecretKey-2025!@"
JWT_ISSUER="ZiraAI_Staging"
JWT_AUDIENCE="ZiraAI_Staging_Users"
JWT_ACCESS_TOKEN_EXPIRE_HOURS="1"
JWT_REFRESH_TOKEN_EXPIRE_HOURS="72"

# ====================
# N8N Webhook Configuration - UPDATED ✅
# ====================
N8N__WebhookUrl="https://primary-staging-9ec7.up.railway.app/webhook/api/plant-analysis"
N8N__UseImageUrl="true"

# ====================
# RabbitMQ Configuration (Currently Disabled)
# ====================
RabbitMQ__ConnectionString="amqp://guest:guest@localhost:5672/"
RabbitMQ__Queues__PlantAnalysisRequest="plant-analysis-requests"
RabbitMQ__Queues__PlantAnalysisResult="plant-analysis-results"
RabbitMQ__Queues__Notification="notifications"
RabbitMQ__RetrySettings__MaxRetryAttempts="3"
RabbitMQ__RetrySettings__RetryDelayMilliseconds="2000"
RabbitMQ__ConnectionSettings__RequestedHeartbeat="120"
RabbitMQ__ConnectionSettings__NetworkRecoveryInterval="15"

# ====================
# File Storage Configuration
# ====================
FileStorage__Provider="FreeImageHost"

# ImgBB Configuration
FileStorage__ImgBB__ApiKey="STAGING_IMGBB_API_KEY_HERE"
FileStorage__ImgBB__ExpirationSeconds="86400"
IMGBB_API_KEY="STAGING_IMGBB_API_KEY_HERE"

# FreeImageHost Configuration
FileStorage__FreeImageHost__ApiKey="6d207e02198a847aa98d0a2a901485a5"
FREEIMAGEHOST_API_KEY="6d207e02198a847aa98d0a2a901485a5"

# Local Storage Configuration
FileStorage__Local__BasePath="wwwroot/uploads"
FileStorage__Local__BaseUrl="https://ziraai-api-sit.up.railway.app"

# S3 Storage Configuration (for future use)
FileStorage__S3__BucketName="ziraai-staging-images"
FileStorage__S3__Region="us-east-1"
FileStorage__S3__UseCloudFront="true"
FileStorage__S3__CloudFrontDomain="cdn-staging.ziraai.com"

# ====================
# Service Feature Flags
# ====================
UseElasticsearch="false"
UseHangfire="false"
UseRabbitMQ="false"
UseRedis="true"
UseTaskScheduler="false"

# ====================
# Task Scheduler Configuration (Hangfire)
# ====================
TaskScheduler__UseTaskScheduler="false"
TaskSchedulerOptions__Enabled="false"
TaskSchedulerOptions__ConnectionString="Host=tramway.proxy.rlwy.net;Port=39540;Database=railway;Username=postgres;Password=cEAvVsWsZIHDUaUKUMiSTRaTGmuswdEd"
TaskSchedulerOptions__StorageType="postgresql"
TaskSchedulerOptions__Path="/hangfire"
TaskSchedulerOptions__Title="Ziraai Hangfire Dashboard"
TaskSchedulerOptions__Username="admin"
TaskSchedulerOptions__Password="admin123"

# ====================
# Logging Configuration
# ====================
LOG_LEVEL="Information"
Logging__LogLevel__Default="Information"
Logging__LogLevel__Microsoft="Warning"
Logging__LogLevel__Microsoft.Hosting.Lifetime="Information"
Logging__LogLevel__System="Information"
Logging__Console__IncludeScopes="true"
Logging__Console__LogLevel__Default="Information"
DOTNET_CONSOLE_ANSI_COLOR="1"
ASPNETCORE_LOGGING__CONSOLE__DISABLECOLORS="false"

# ====================
# SeriLog Configuration
# ====================
SERILOG_CONNECTION_STRING="Host=tramway.proxy.rlwy.net;Port=39540;Database=railway;Username=postgres;Password=cEAvVsWsZIHDUaUKUMiSTRaTGmuswdEd"
SeriLogConfigurations__PostgreSqlLogConfiguration__ConnectionString="Host=tramway.proxy.rlwy.net;Port=39540;Database=railway;Username=postgres;Password=cEAvVsWsZIHDUaUKUMiSTRaTGmuswdEd"
SeriLogConfigurations__FileLogConfiguration__FolderPath="/app/logs/staging/"
SeriLogConfigurations__FileLogConfiguration__RollingInterval="Day"
SeriLogConfigurations__FileLogConfiguration__RetainedFileCountLimit="7"
SeriLogConfigurations__FileLogConfiguration__FileSizeLimitBytes="20971520"
SeriLogConfigurations__FileLogConfiguration__OutputTemplate="{Timestamp:yyyy-MM-dd HH:mm:ss.fff zzz} [{Level}] {Message}{NewLine}{Exception}"

# ====================
# AI Image Optimization Configuration
# ====================
AI_OPTIMIZATION_ENABLED="true"
AI_OPTIMIZATION_MAX_SIZE_MB="0.25"
AI_OPTIMIZATION_MAX_WIDTH="1024"
AI_OPTIMIZATION_MAX_HEIGHT="768"
AI_OPTIMIZATION_QUALITY="80"

AIOptimization__Enabled="true"
AIOptimization__MaxSizeMB="0.25"
AIOptimization__MaxWidth="1024"
AIOptimization__MaxHeight="768"
AIOptimization__Quality="80"

# ====================
# Sponsor Request Configuration
# ====================
REQUEST_TOKEN_SECRET="ZiraAI-SponsorRequest-Staging-SecretKey-2025!@"
SPONSOR_REQUEST_TOKEN_EXPIRY_HOURS="24"
SPONSOR_REQUEST_MAX_REQUESTS_PER_DAY="10"
SPONSOR_REQUEST_DEEPLINK_BASE_URL="https://ziraai-api-sit.up.railway.app/sponsor-request/"

# ====================
# CORS Configuration
# ====================
CORS_ALLOWED_ORIGINS="https://ziraai-api-sit.up.railway.app"
AllowedHosts="*"

# ====================
# WhatsApp Business API Configuration (Future Use)
# ====================
WhatsApp__ApiUrl="https://graph.facebook.com/v18.0/"
WhatsApp__AccessToken="YOUR_WHATSAPP_ACCESS_TOKEN_HERE"
WhatsApp__PhoneNumberId="YOUR_PHONE_NUMBER_ID_HERE"
WhatsApp__BusinessAccountId="YOUR_BUSINESS_ACCOUNT_ID_HERE"
WhatsApp__VerifyToken="ziraai_webhook_verification_token"
WhatsApp__WebhookUrl="/api/v1/webhooks/whatsapp"
WhatsApp__MaxRetryAttempts="3"
WhatsApp__RequestTimeoutSeconds="30"
WhatsApp__RateLimitPerSecond="80"
WhatsApp__DefaultLanguage="tr"
WhatsApp__EnableDeliveryStatusTracking="true"
WhatsApp__EnableReadReceiptsTracking="true"
WhatsApp__FallbackToSMS="true"

# ====================
# Notification Settings
# ====================
NotificationSettings__DefaultChannel="WhatsApp"
NotificationSettings__EnableQuietHours="true"
NotificationSettings__DefaultQuietHoursStart="22:00"
NotificationSettings__DefaultQuietHoursEnd="08:00"
NotificationSettings__MaxNotificationsPerUserPerDay="10"
NotificationSettings__EnableUserPreferences="true"
NotificationSettings__RetryFailedNotifications="true"
NotificationSettings__EnableNotificationAnalytics="true"

# ====================
# Mail Settings (SMTP - Future Use)
# ====================
MailSettings__Server="smtp.gmail.com"
MailSettings__Port="587"
MailSettings__SenderFullName="Ziraai"
MailSettings__SenderEmail=""
MailSettings__UserName=""
MailSettings__Password=""
MailSettings__UseSSL="false"
MailSettings__UseStartTls="true"

# ====================
# ElasticSearch Configuration (Currently Disabled)
# ====================
ElasticSearchConfig__ConnectionString="http://localhost:9200"
ElasticSearchConfig__UserName=""
ElasticSearchConfig__Password=""

# ====================
# MongoDB Configuration (Future Use)
# ====================
MongoDbSettings__ConnectionString="mongodb://localhost:27017/ziraaidb?readPreference=primary&appname=MongoDB%20Compass&ssl=false"
MongoDbSettings__DatabaseName="ziraaidb"

# ====================
# Performance Monitoring
# ====================
SeriLogConfigurations__PerformanceMonitoring__Enabled="true"
SeriLogConfigurations__PerformanceMonitoring__SlowOperationThresholdMs="1000"
SeriLogConfigurations__PerformanceMonitoring__CriticalOperationThresholdMs="3000"
SeriLogConfigurations__PerformanceMonitoring__EnableDetailedHttpLogging="true"
SeriLogConfigurations__PerformanceMonitoring__LogRequestHeaders="false"
SeriLogConfigurations__PerformanceMonitoring__LogResponseHeaders="false"

# ====================
# Debug Settings
# ====================
STARTUP_DEBUG="true"

# ====================
# NOTES FOR RAILWAY DEPLOYMENT
# ====================
# 1. This file contains ALL environment variables needed for Railway staging
# 2. Copy these variables to Railway dashboard > Variables section
# 3. Critical variables that MUST be set:
#    - DATABASE_CONNECTION_STRING & ConnectionStrings__DArchPgContext
#    - Redis configuration (all CacheOptions__ variables)
#    - N8N__WebhookUrl (updated to use Railway staging URL)
#    - TokenOptions__ (JWT configuration)
# 4. Services currently DISABLED in staging:
#    - RabbitMQ (UseRabbitMQ="false")
#    - ElasticSearch (UseElasticsearch="false")
#    - Hangfire (UseHangfire="false")
# 5. Redis SSL is DISABLED for Railway (CacheOptions__Ssl="false")
# 6. N8N webhook URL is set to: https://primary-staging-9ec7.up.railway.app/webhook/api/plant-analysis